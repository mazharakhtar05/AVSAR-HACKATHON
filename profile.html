<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Profile - AVSAR Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #f7f9fc;
        }
        .tricolor-bar { 
            height: 5px; 
            width: 100%; 
            background: linear-gradient(to right, #FF9933 33.3%, #FFFFFF 33.3%, #FFFFFF 66.6%, #138808 66.6%); 
        }
        .profile-card {
            background-color: white;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
        }
        .section-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: #1e3a8a; /* A darker blue for headings */
            border-bottom: 2px solid #dbeafe;
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
        }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <div class="tricolor-bar"></div>

    <header class="bg-white/95 backdrop-blur-sm shadow-sm sticky top-0 z-50 border-b border-gray-200">
        <div class="max-w-screen-xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <img src="https://upload.wikimedia.org/wikipedia/commons/5/55/Emblem_of_India.svg" alt="National Emblem of India" class="h-12">
                <div>
                    <h1 class="text-xl font-bold text-gray-800">AVSAR</h1>
                    <p class="text-sm text-gray-500">National Internship Portal</p>
                </div>
            </div>
            <a href="/recommendations" class="text-sm font-semibold text-gray-600 hover:text-blue-600 transition flex items-center gap-2">
                <i class="fas fa-arrow-left"></i> <span>Back to Recommendations</span>
            </a>
        </div>
    </header>

    <main class="flex-grow py-12">
        <div class="max-w-4xl mx-auto px-4">
            <div class="profile-card p-6 md:p-10">
                <div class="flex flex-col sm:flex-row items-center space-y-4 sm:space-y-0 sm:space-x-8 pb-8 border-b">
                    <img id="profile-photo" class="h-32 w-32 object-cover rounded-full border-4 border-white shadow-lg" src="https://placehold.co/128x128/e2e8f0/718096?text=Photo" alt="Profile photo" />
                    <div class="text-center sm:text-left">
                        <h2 id="profile-name" class="text-4xl font-extrabold text-gray-900">Loading...</h2>
                        <p id="profile-location" class="text-gray-600 mt-1">City, State</p>
                        <div class="flex justify-center sm:justify-start space-x-4 mt-3">
                            <a id="profile-linkedin" href="#" target="_blank" class="text-gray-500 hover:text-blue-700 transition hidden"><i class="fab fa-linkedin fa-2x"></i></a>
                            <a id="profile-github" href="#" target="_blank" class="text-gray-500 hover:text-gray-900 transition hidden"><i class="fab fa-github fa-2x"></i></a>
                        </div>
                    </div>
                     <a href="/application-form" class="sm:ml-auto bg-blue-600 text-white font-bold rounded-lg px-5 py-2.5 hover:bg-blue-700 transition-colors duration-200 text-sm flex items-center gap-2">
                        <i class="fas fa-edit"></i> Edit Profile
                    </a>
                </div>

                <div id="about-section" class="py-6 border-b" style="display: none;">
                    <h3 class="section-title">About Me</h3>
                    <p id="profile-about" class="text-gray-700 whitespace-pre-line"></p>
                </div>

                <div class="py-6 grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4 border-b">
                    <div><strong class="font-semibold text-gray-500 block">Email Address</strong> <span id="profile-email" class="text-gray-800"></span></div>
                    <div><strong class="font-semibold text-gray-500 block">Phone Number</strong> <span id="profile-phone" class="text-gray-800"></span></div>
                    <div><strong class="font-semibold text-gray-500 block">Date of Birth</strong> <span id="profile-dob" class="text-gray-800"></span></div>
                </div>

                <div class="py-6 border-b">
                     <h3 class="section-title">Education</h3>
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4">
                        <div><strong class="font-semibold text-gray-500 block">College/University</strong> <span id="profile-college" class="text-gray-800"></span></div>
                        <div><strong class="font-semibold text-gray-500 block">Highest Qualification</strong> <span id="profile-qualification" class="text-gray-800"></span></div>
                        <div><strong class="font-semibold text-gray-500 block">Field of Study</strong> <span id="profile-stream" class="text-gray-800"></span></div>
                        <div><strong class="font-semibold text-gray-500 block">Year of Completion</strong> <span id="profile-year" class="text-gray-800"></span></div>
                     </div>
                </div>
                
                <div class="py-6 border-b">
                    <h3 class="section-title">Interested Sectors</h3>
                    <div id="profile-interests" class="flex flex-wrap gap-3">
                        <span class="bg-gray-100 text-gray-600 text-sm font-medium px-4 py-2 rounded-full">Loading interests...</span>
                    </div>
                </div>

                <div class="py-6">
                    <h3 class="section-title">Skills</h3>
                    <div id="profile-skills" class="flex flex-wrap gap-3">
                        <span class="bg-gray-100 text-gray-600 text-sm font-medium px-4 py-2 rounded-full">Loading skills...</span>
                    </div>
                </div>

            </div>
        </div>
    </main>
    
    <footer class="text-center p-6 text-sm text-gray-600 bg-white border-t mt-auto">
        <p>&copy; 2024 Portal is Designed, Developed and Hosted by National Informatics Centre (NIC), Ministry of Electronics and Information Technology, Government of India.</p>
    </footer>

    <script>
        function populateProfile(data) {
            document.getElementById('profile-photo').src = data.photo || 'https://placehold.co/128x128/e2e8f0/718096?text=Photo';
            document.getElementById('profile-name').textContent = data.fullName || 'N/A';
            document.getElementById('profile-location').textContent = `${data.city || 'City'}, ${data.state || 'State'}`;
            
            const linkedinLink = document.getElementById('profile-linkedin');
            const githubLink = document.getElementById('profile-github');
            if (data.linkedin) { linkedinLink.href = data.linkedin; linkedinLink.classList.remove('hidden'); }
            if (data.github) { githubLink.href = data.github; githubLink.classList.remove('hidden'); }

            const aboutSection = document.getElementById('about-section');
            if (data.about) { document.getElementById('profile-about').textContent = data.about; aboutSection.style.display = 'block'; }

            document.getElementById('profile-email').textContent = data.email || 'N/A';
            document.getElementById('profile-phone').textContent = data.phone || 'N/A';
            document.getElementById('profile-dob').textContent = data.dob || 'N/A';
            document.getElementById('profile-college').textContent = data.college || 'N/A';
            document.getElementById('profile-qualification').textContent = data.qualification || 'N/A';
            document.getElementById('profile-stream').textContent = data.stream || 'N/A';
            document.getElementById('profile-year').textContent = data.year || 'N/A';
            
            const interestsContainer = document.getElementById('profile-interests');
            interestsContainer.innerHTML = '';
            const userInterests = data.interests || [];
            if (userInterests.length > 0) {
                userInterests.forEach(interest => {
                    const pill = document.createElement('span');
                    pill.className = 'bg-green-100 text-green-800 text-sm font-semibold mr-2 px-4 py-2 rounded-full';
                    pill.textContent = interest;
                    interestsContainer.appendChild(pill);
                });
            } else {
                interestsContainer.innerHTML = '<p class="text-gray-500">No interests added yet.</p>';
            }

            const skillsContainer = document.getElementById('profile-skills');
            skillsContainer.innerHTML = '';
            const userSkills = data.skills || [];
            if (userSkills.length > 0) {
                userSkills.forEach(skill => {
                    const pill = document.createElement('span');
                    pill.className = 'bg-blue-100 text-blue-800 text-sm font-semibold mr-2 px-4 py-2 rounded-full';
                    pill.textContent = skill;
                    skillsContainer.appendChild(pill);
                });
            } else {
                skillsContainer.innerHTML = '<p class="text-gray-500">No skills added yet.</p>';
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            fetch('/get_application_data')
                .then(response => response.json())
                .then(data => {
                    if (data && !data.error) {
                        populateProfile(data);
                    } else {
                        console.error('Failed to load user data.');
                    }
                });
        });
    </script>
</body>
</html>